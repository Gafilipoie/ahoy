var jscolor={dir:"",bindClass:"color",binding:!0,preloading:!0,install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){jscolor.binding&&jscolor.bind(),jscolor.preloading&&jscolor.preload()},getDir:function(){if(!jscolor.dir){var a=jscolor.detectDir();jscolor.dir=!1===a?"jscolor/":a}return jscolor.dir},detectDir:function(){for(var a=location.href,b=document.getElementsByTagName("base"),c=0;c<b.length;c+=1)b[c].href&&(a=b[c].href);for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c+=1)if(b[c].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(b[c].src)){var d=new jscolor.URI(b[c].src),f=d.toAbsolute(a);return f.path=f.path.replace(/[^\/]+$/,""),f.query=null,f.fragment=null,f.toString()}return!1},bind:function(){for(var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i"),e=document.getElementsByTagName("input"),i=0;i<e.length;i+=1){var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3])try{eval("prop="+m[3])}catch(a){}e[i].color=new jscolor.color(e[i],prop)}}},preload:function(){for(var a in jscolor.imgRequire)jscolor.imgRequire.hasOwnProperty(a)&&jscolor.loadImage(a)},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(a){jscolor.imgRequire[a]=!0},loadImage:function(a){jscolor.imgLoaded[a]||(jscolor.imgLoaded[a]=new Image,jscolor.imgLoaded[a].src=jscolor.getDir()+a)},fetchElement:function(a){return"string"==typeof a?document.getElementById(a):a},addEvent:function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},fireEvent:function(a,b){if(a)if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(b,!0,!0),a.dispatchEvent(c)}else if(document.createEventObject){var c=document.createEventObject();a.fireEvent("on"+b,c)}else a["on"+b]&&a["on"+b]()},getElementPos:function(a){var b=a,c=a,d=0,e=0;if(b.offsetParent)do d+=b.offsetLeft,e+=b.offsetTop;while(b=b.offsetParent);for(;(c=c.parentNode)&&"BODY"!==c.nodeName.toUpperCase();)d-=c.scrollLeft,e-=c.scrollTop;return[d,e]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getRelMousePos:function(a){var b=0,c=0;return a||(a=window.event),"number"==typeof a.offsetX?(b=a.offsetX,c=a.offsetY):"number"==typeof a.layerX&&(b=a.layerX,c=a.layerY),{x:b,y:c}},getViewPos:function(){return"number"==typeof window.pageYOffset?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},getViewSize:function(){return"number"==typeof window.innerWidth?[window.innerWidth,window.innerHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?[document.body.clientWidth,document.body.clientHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:[0,0]},URI:function(a){function b(a){for(var b="";a;)if("../"===a.substr(0,3)||"./"===a.substr(0,2))a=a.replace(/^\.+/,"").substr(1);else if("/./"===a.substr(0,3)||"/."===a)a="/"+a.substr(3);else if("/../"===a.substr(0,4)||"/.."===a)a="/"+a.substr(4),b=b.replace(/\/?[^\/]*$/,"");else if("."===a||".."===a)a="";else{var c=a.match(/^\/?[^\/]*/)[0];a=a.substr(c.length),b+=c}return b}this.scheme=null,this.authority=null,this.path="",this.query=null,this.fragment=null,this.parse=function(a){var b=a.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);return this.scheme=b[3]?b[2]:null,this.authority=b[5]?b[6]:null,this.path=b[7],this.query=b[9]?b[10]:null,this.fragment=b[12]?b[13]:null,this},this.toString=function(){var a="";return null!==this.scheme&&(a=a+this.scheme+":"),null!==this.authority&&(a=a+"//"+this.authority),null!==this.path&&(a+=this.path),null!==this.query&&(a=a+"?"+this.query),null!==this.fragment&&(a=a+"#"+this.fragment),a},this.toAbsolute=function(a){var a=new jscolor.URI(a),c=this,d=new jscolor.URI;return null!==a.scheme&&(null!==c.scheme&&c.scheme.toLowerCase()===a.scheme.toLowerCase()&&(c.scheme=null),null===c.scheme?(null===c.authority?(""===c.path?(d.path=a.path,d.query=null===c.query?a.query:c.query):("/"===c.path.substr(0,1)?d.path=b(c.path):(d.path=null!==a.authority&&""===a.path?"/"+c.path:a.path.replace(/[^\/]+$/,"")+c.path,d.path=b(d.path)),d.query=c.query),d.authority=a.authority):(d.authority=c.authority,d.path=b(c.path),d.query=c.query),d.scheme=a.scheme):(d.scheme=c.scheme,d.authority=c.authority,d.path=b(c.path),d.query=c.query),d.fragment=c.fragment,d)},a&&this.parse(a)},color:function(target,prop){function RGB_HSV(a,c,d){var b=Math.min(Math.min(a,c),d),e=Math.max(Math.max(a,c),d),f=e-b;if(0===f)return[null,0,e];var g=a===b?3+(d-c)/f:c===b?5+(a-d)/f:1+(c-a)/f;return[6==g?0:g,f/e,e]}function HSV_RGB(a,b,c){if(null===a)return[c,c,c];var d=Math.floor(a),e=d%2?a-d:1-(a-d),f=c*(1-b),g=c*(1-b*e);return 6===d||0===d?[c,g,f]:1===d?[g,c,f]:2===d?[f,c,g]:3===d?[f,g,c]:4===d?[g,f,c]:5===d?[c,f,g]:void 0}function removePicker(){delete jscolor.picker.owner,document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function drawPicker(a,b){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(THIS.pickerCloseText)};for(var c,d=0;d<jscolor.images.sld[1];d+=4)c=document.createElement("div"),c.style.height="4px",c.style.fontSize="1px",c.style.lineHeight="0",jscolor.picker.sld.appendChild(c);jscolor.picker.sldB.appendChild(jscolor.picker.sld),jscolor.picker.box.appendChild(jscolor.picker.sldB),jscolor.picker.box.appendChild(jscolor.picker.sldM),jscolor.picker.padB.appendChild(jscolor.picker.pad),jscolor.picker.box.appendChild(jscolor.picker.padB),jscolor.picker.box.appendChild(jscolor.picker.padM),jscolor.picker.btnS.appendChild(jscolor.picker.btnT),jscolor.picker.btn.appendChild(jscolor.picker.btnS),jscolor.picker.box.appendChild(jscolor.picker.btn),jscolor.picker.boxB.appendChild(jscolor.picker.box)}var e=jscolor.picker;e.box.onmouseup=e.box.onmouseout=function(){target.focus()},e.box.onmousedown=function(){abortBlur=!0},e.box.onmousemove=function(a){(holdPad||holdSld)&&(holdPad&&setPad(a),holdSld&&setSld(a),document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),dispatchImmediateChange())},e.padM.onmouseup=e.padM.onmouseout=function(){holdPad&&(holdPad=!1,jscolor.fireEvent(valueElement,"change"))},e.padM.onmousedown=function(a){switch(modeID){case 0:0===THIS.hsv[2]&&THIS.fromHSV(null,null,1);;break;case 1:0===THIS.hsv[1]&&THIS.fromHSV(null,1,null);;}holdPad=!0,setPad(a),dispatchImmediateChange()},e.sldM.onmouseup=e.sldM.onmouseout=function(){holdSld&&(holdSld=!1,jscolor.fireEvent(valueElement,"change"))},e.sldM.onmousedown=function(a){holdSld=!0,setSld(a),dispatchImmediateChange()};var f=getPickerDims(THIS);e.box.style.width=f[0]+"px",e.box.style.height=f[1]+"px",e.boxB.style.position="absolute",e.boxB.style.clear="both",e.boxB.style.left=a+"px",e.boxB.style.top=b+"px",e.boxB.style.zIndex=THIS.pickerZIndex,e.boxB.style.border=THIS.pickerBorder+"px solid",e.boxB.style.borderColor=THIS.pickerBorderColor,e.boxB.style.background=THIS.pickerFaceColor,e.pad.style.width=jscolor.images.pad[0]+"px",e.pad.style.height=jscolor.images.pad[1]+"px",e.padB.style.position="absolute",e.padB.style.left=THIS.pickerFace+"px",e.padB.style.top=THIS.pickerFace+"px",e.padB.style.border=THIS.pickerInset+"px solid",e.padB.style.borderColor=THIS.pickerInsetColor,e.padM.style.position="absolute",e.padM.style.left="0",e.padM.style.top="0",e.padM.style.width=THIS.pickerFace+2*THIS.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px",e.padM.style.height=e.box.style.height,e.padM.style.cursor="crosshair",e.sld.style.overflow="hidden",e.sld.style.width=jscolor.images.sld[0]+"px",e.sld.style.height=jscolor.images.sld[1]+"px",e.sldB.style.display=THIS.slider?"block":"none",e.sldB.style.position="absolute",e.sldB.style.right=THIS.pickerFace+"px",e.sldB.style.top=THIS.pickerFace+"px",e.sldB.style.border=THIS.pickerInset+"px solid",e.sldB.style.borderColor=THIS.pickerInsetColor,e.sldM.style.display=THIS.slider?"block":"none",e.sldM.style.position="absolute",e.sldM.style.right="0",e.sldM.style.top="0",e.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+THIS.pickerFace+2*THIS.pickerInset+"px",e.sldM.style.height=e.box.style.height;try{e.sldM.style.cursor="pointer"}catch(a){e.sldM.style.cursor="hand"}e.btn.style.display=THIS.pickerClosable?"block":"none",e.btn.style.position="absolute",e.btn.style.left=THIS.pickerFace+"px",e.btn.style.bottom=THIS.pickerFace+"px",e.btn.style.padding="0 15px",e.btn.style.height="18px",e.btn.style.border=THIS.pickerInset+"px solid",function(){var a=THIS.pickerInsetColor.split(/\s+/),b=2>a.length?a[0]:a[1]+" "+a[0]+" "+a[0]+" "+a[1];e.btn.style.borderColor=b}(),e.btn.style.color=THIS.pickerButtonColor,e.btn.style.font="12px sans-serif",e.btn.style.textAlign="center";try{e.btn.style.cursor="pointer"}catch(a){e.btn.style.cursor="hand"}switch(e.btn.onmousedown=function(){THIS.hidePicker()},e.btnS.style.lineHeight=e.btn.style.height,modeID){case 0:var g="hs.png";break;case 1:var g="hv.png";}e.padM.style.backgroundImage="url('"+jscolor.getDir()+"cross.gif')",e.padM.style.backgroundRepeat="no-repeat",e.sldM.style.backgroundImage="url('"+jscolor.getDir()+"arrow.gif')",e.sldM.style.backgroundRepeat="no-repeat",e.pad.style.backgroundImage="url('"+jscolor.getDir()+g+"')",e.pad.style.backgroundRepeat="no-repeat",e.pad.style.backgroundPosition="0 0",redrawPad(),redrawSld(),jscolor.picker.owner=THIS,document.getElementsByTagName("body")[0].appendChild(e.boxB)}function getPickerDims(a){var b=[2*a.pickerInset+2*a.pickerFace+jscolor.images.pad[0]+(a.slider?2*a.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),a.pickerClosable?4*a.pickerInset+3*a.pickerFace+jscolor.images.pad[1]+a.pickerButtonHeight:2*a.pickerInset+2*a.pickerFace+jscolor.images.pad[1]];return b}function redrawPad(){switch(modeID){case 0:var a=1;break;case 1:var a=2;}var b=Math.round(THIS.hsv[0]/6*(jscolor.images.pad[0]-1)),d=Math.round((1-THIS.hsv[a])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=THIS.pickerFace+THIS.pickerInset+b-Math.floor(jscolor.images.cross[0]/2)+"px "+(THIS.pickerFace+THIS.pickerInset+d-Math.floor(jscolor.images.cross[1]/2))+"px";var e=jscolor.picker.sld.childNodes;switch(modeID){case 0:for(var g=HSV_RGB(THIS.hsv[0],THIS.hsv[1],1),h=0;h<e.length;h+=1)e[h].style.backgroundColor="rgb("+100*(g[0]*(1-h/e.length))+"%,"+100*(g[1]*(1-h/e.length))+"%,"+100*(g[2]*(1-h/e.length))+"%)";break;case 1:var g,j,k=[THIS.hsv[2],0,0],h=Math.floor(THIS.hsv[0]),c=h%2?THIS.hsv[0]-h:1-(THIS.hsv[0]-h);6===h||0===h?g=[0,1,2]:1===h?g=[1,0,2]:2===h?g=[2,0,1]:3===h?g=[2,1,0]:4===h?g=[1,2,0]:5===h?g=[0,2,1]:void 0;for(var h=0;h<e.length;h+=1)j=1-1/(e.length-1)*h,k[1]=k[0]*(1-j*c),k[2]=k[0]*(1-j),e[h].style.backgroundColor="rgb("+100*k[g[0]]+"%,"+100*k[g[1]]+"%,"+100*k[g[2]]+"%)";}}function redrawSld(){switch(modeID){case 0:var a=2;break;case 1:var a=1;}var b=Math.round((1-THIS.hsv[a])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(THIS.pickerFace+THIS.pickerInset+b-Math.floor(jscolor.images.arrow[1]/2))+"px"}function isPickerOwner(){return jscolor.picker&&jscolor.picker.owner===THIS}function blurTarget(){valueElement===target&&THIS.importColor(),THIS.pickerOnfocus&&THIS.hidePicker()}function blurValue(){valueElement!==target&&THIS.importColor()}function setPad(a){var b=jscolor.getRelMousePos(a),c=b.x-THIS.pickerFace-THIS.pickerInset,d=b.y-THIS.pickerFace-THIS.pickerInset;0===modeID?THIS.fromHSV(c*(6/(jscolor.images.pad[0]-1)),1-d/(jscolor.images.pad[1]-1),null,leaveSld):1===modeID?THIS.fromHSV(c*(6/(jscolor.images.pad[0]-1)),null,1-d/(jscolor.images.pad[1]-1),leaveSld):void 0}function setSld(a){var b=jscolor.getRelMousePos(a),c=b.y-THIS.pickerFace-THIS.pickerInset;0===modeID?THIS.fromHSV(null,null,1-c/(jscolor.images.sld[1]-1),leavePad):1===modeID?THIS.fromHSV(null,1-c/(jscolor.images.sld[1]-1),null,leavePad):void 0}function dispatchImmediateChange(){THIS.onImmediateChange&&("string"==typeof THIS.onImmediateChange?eval(THIS.onImmediateChange):THIS.onImmediateChange(THIS))}for(var p in this.required=!0,this.adjust=!0,this.hash=!1,this.caps=!0,this.slider=!0,this.valueElement=target,this.styleElement=target,this.onImmediateChange=null,this.hsv=[0,0,1],this.rgb=[1,1,1],this.pickerOnfocus=!0,this.pickerMode="HSV",this.pickerPosition="bottom",this.pickerSmartPosition=!0,this.pickerButtonHeight=20,this.pickerClosable=!1,this.pickerCloseText="Close",this.pickerButtonColor="ButtonText",this.pickerFace=10,this.pickerFaceColor="ThreeDFace",this.pickerBorder=1,this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight",this.pickerInset=1,this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow",this.pickerZIndex=1e4,prop)prop.hasOwnProperty(p)&&(this[p]=prop[p]);this.hidePicker=function(){isPickerOwner()&&removePicker()},this.showPicker=function(){if(!isPickerOwner()){var d,e,f,g=jscolor.getElementPos(target),h=jscolor.getElementSize(target),i=jscolor.getViewPos(),j=jscolor.getViewSize(),k=getPickerDims(this);switch(this.pickerPosition.toLowerCase()){case"left":d=1,e=0,f=-1;break;case"right":d=1,e=0,f=1;break;case"top":d=0,e=1,f=-1;break;default:d=0,e=1,f=1;}var m=(h[e]+k[e])/2;if(!this.pickerSmartPosition)var l=[g[d],g[e]+h[e]-m+m*f];else var l=[-i[d]+g[d]+k[d]>j[d]?-i[d]+g[d]+h[d]/2>j[d]/2&&0<=g[d]+h[d]-k[d]?g[d]+h[d]-k[d]:g[d]:g[d],-i[e]+g[e]+h[e]+k[e]-m+m*f>j[e]?-i[e]+g[e]+h[e]/2>j[e]/2&&0<=g[e]+h[e]-m-m*f?g[e]+h[e]-m-m*f:g[e]+h[e]-m+m*f:0<=g[e]+h[e]-m+m*f?g[e]+h[e]-m+m*f:g[e]+h[e]-m-m*f];drawPicker(l[d],l[e])}},this.importColor=function(){valueElement?this.adjust?!this.required&&/^\s*$/.test(valueElement.value)?(valueElement.value="",styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage,styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor,styleElement.style.color=styleElement.jscStyle.color,this.exportColor(leaveValue|leaveStyle)):this.fromString(valueElement.value)||this.exportColor():!this.fromString(valueElement.value,leaveValue)&&(styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage,styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor,styleElement.style.color=styleElement.jscStyle.color,this.exportColor(leaveValue|leaveStyle)):this.exportColor()},this.exportColor=function(a){if(!(a&leaveValue)&&valueElement){var b=this.toString();this.caps&&(b=b.toUpperCase()),this.hash&&(b="#"+b),valueElement.value=b}!(a&leaveStyle)&&styleElement&&(styleElement.style.backgroundImage="none",styleElement.style.backgroundColor="#"+this.toString(),styleElement.style.color=.5>.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]?"#FFF":"#000"),!(a&leavePad)&&isPickerOwner()&&redrawPad(),!(a&leaveSld)&&isPickerOwner()&&redrawSld()},this.fromHSV=function(a,b,c,d){0>a&&(a=0)||6<a&&(a=6),0>b&&(b=0)||1<b&&(b=1),0>c&&(c=0)||1<c&&(c=1),this.rgb=HSV_RGB(null===a?this.hsv[0]:this.hsv[0]=a,null===b?this.hsv[1]:this.hsv[1]=b,null===c?this.hsv[2]:this.hsv[2]=c),this.exportColor(d)},this.fromRGB=function(a,c,d,e){0>a&&(a=0)||1<a&&(a=1),0>c&&(c=0)||1<c&&(c=1),0>d&&(d=0)||1<d&&(d=1);var f=RGB_HSV(null===a?this.rgb[0]:this.rgb[0]=a,null===c?this.rgb[1]:this.rgb[1]=c,null===d?this.rgb[2]:this.rgb[2]=d);null!==f[0]&&(this.hsv[0]=f[0]),0!==f[2]&&(this.hsv[1]=f[1]),this.hsv[2]=f[2],this.exportColor(e)},this.fromString=function(a,b){var c=a.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);return!!c&&(6===c[1].length?this.fromRGB(parseInt(c[1].substr(0,2),16)/255,parseInt(c[1].substr(2,2),16)/255,parseInt(c[1].substr(4,2),16)/255,b):this.fromRGB(parseInt(c[1].charAt(0)+c[1].charAt(0),16)/255,parseInt(c[1].charAt(1)+c[1].charAt(1),16)/255,parseInt(c[1].charAt(2)+c[1].charAt(2),16)/255,b),!0)},this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};var THIS=this,modeID="hvs"===this.pickerMode.toLowerCase()?1:0,abortBlur=!1,valueElement=jscolor.fetchElement(this.valueElement),styleElement=jscolor.fetchElement(this.styleElement),holdPad=!1,holdSld=!1,leaveValue=1,leaveStyle=2,leavePad=4,leaveSld=8;if(jscolor.addEvent(target,"focus",function(){THIS.pickerOnfocus&&THIS.showPicker()}),jscolor.addEvent(target,"blur",function(){abortBlur?abortBlur=!1:window.setTimeout(function(){abortBlur||blurTarget(),abortBlur=!1},0)}),valueElement){var updateField=function(){THIS.fromString(valueElement.value,leaveValue),dispatchImmediateChange()};jscolor.addEvent(valueElement,"keyup",updateField),jscolor.addEvent(valueElement,"input",updateField),jscolor.addEvent(valueElement,"blur",blurValue),valueElement.setAttribute("autocomplete","off")}styleElement&&(styleElement.jscStyle={backgroundImage:styleElement.style.backgroundImage,backgroundColor:styleElement.style.backgroundColor,color:styleElement.style.color}),0===modeID?jscolor.requireImage("hs.png"):1===modeID?jscolor.requireImage("hv.png"):void 0,jscolor.requireImage("cross.gif"),jscolor.requireImage("arrow.gif"),this.importColor()}};jscolor.install();
